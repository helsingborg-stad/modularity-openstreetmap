(()=>{"use strict";var e={86:(e,t)=>{t.A=class{constructor(e,t){this.selectFieldKey=e,this.storage=t}updateExistsingRows(e,t){const s=this.storage.getTaxonomies(t),o=this.storage.getSelected(t);[...e.querySelectorAll(`tr.acf-row:not(.acf-clone) [data-key="${this.selectFieldKey}"] select`)].forEach((e,t)=>{e.innerHTML="",this.addSelectFieldOptions(e,t,s,o)})}addSelectFieldOptions(e,t,s,o){for(const i in s){const a=document.createElement("option");a.selected=!(!o[t]||o[t]!==i),a.value=i,a.text=s[i],e.appendChild(a)}}}},111:(e,t)=>{t.A=class{constructor(e,t){this.taxonomies=e,this.selected=t}getSelected(e){return this.selected.hasOwnProperty(e)?this.selected[e]:[]}getTaxonomies(e){return this.taxonomies.hasOwnProperty(e)?this.taxonomies[e]:[]}}},153:(e,t)=>{t.A=class{constructor(e,t,s,o,i,a){this.container=e,this.acf=t,this.postTypeSelectFieldKey=s,this.filterSelectFieldKey=o,this.storageInstance=i,this.taxonomySelectUpdaterInstance=a;const n=this.container.querySelector(`[data-key="${this.postTypeSelectFieldKey}"] select`);n&&(n.value&&this.taxonomySelectUpdaterInstance.updateExistsingRows(this.container,n.value),this.listenForPostTypeChanges(n),this.listenForFilterRowsAdded(n))}listenForPostTypeChanges(e){e.addEventListener("change",e=>{const t=e.target.value;this.taxonomySelectUpdaterInstance.updateExistsingRows(this.container,t)})}listenForFilterRowsAdded(e){this.acf.addAction("append",t=>{if(!t.hasOwnProperty(0)||!t[0].classList.contains("acf-row")||!this.container.contains(t[0]))return;const s=t[0].querySelector(`[data-key="${this.filterSelectFieldKey}"] select`);s&&this.taxonomySelectUpdaterInstance.addSelectFieldOptions(s,0,this.storageInstance.getTaxonomies(e.value),[])})}}}},t={};function s(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,s),a.exports}var o=s(86),i=s(111),a=s(153);const n=class{constructor(){const e="field_668d1cc80d853",t=document.querySelector("#acf-group_64219abb0caec");if(t){const[s,n]=this.getOsm(),r=new i.A(s,n),c=new o.A(e,r);new a.A(t,acf,"field_642a8818a908c",e,r,c)}}getOsm(){let e={};try{e=JSON.parse(osm)}catch(e){console.error("Error parsing OSM data",e)}return[e.hasOwnProperty("taxonomies")?e.taxonomies:{},e.hasOwnProperty("selected")?e.selected:{}]}},r=class{initializedOsmBlocks=[];constructor(){this.editor=wp.data.select("core/block-editor");let e=null;wp.data.subscribe(()=>{e&&clearTimeout(e),e=setTimeout(()=>{const e=this.editor.getBlocksByName("acf/open-street-map");0!==e.length&&e.forEach(e=>{this.initializedOsmBlocks.includes(e)||this.tryInitializeBlock(e)})},300)})}initializeBlock(e,t){const s="field_668d1cc80d853",[n,r]=this.getOsm(t),c=new i.A(n,r),l=new o.A(s,c),d=setInterval(()=>{e.querySelector('[data-name="mod_osm_post_type"]')&&(new a.A(e,acf,"field_642a8818a908c",s,c,l),clearInterval(d))},1e3)}tryInitializeBlock(e){const t=document.querySelector("#block-"+e);t&&(this.initializedOsmBlocks.push(e),this.initializeBlock(t,e))}getOsm(e){let t={};try{t=JSON.parse(osm)}catch(e){console.error("Error parsing OSM data",e)}return[t.hasOwnProperty("taxonomies")?t.taxonomies:{},this.getSelected(e)]}getSelected(e){const t=this.editor.getBlockAttributes(e);if(!t?.data?.mod_osm_post_type)return{};let s={};if(s[t.data.mod_osm_post_type]=[],t?.data?.mod_osm_filters>0){let e=0;for(;e<t.data.mod_osm_filters;e++)t.data[`mod_osm_filters_${e}_mod_osm_filter_taxonomy`]&&s[t.data.mod_osm_post_type].push(t.data[`mod_osm_filters_${e}_mod_osm_filter_taxonomy`])}return s}};document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof wp&&"undefined"!=typeof acf&&(document.body.classList.contains("block-editor-page")?new r:new n)})})();
//# sourceMappingURL=modularity-open-street-map.f75ee828e0bcb36c5c55.js.map